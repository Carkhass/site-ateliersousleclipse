---
import "../styles/global.css";
import SectionHeader from "../components/SectionHeader.astro";
import Button from "../components/Button.astro";
import Card from "../components/Card.astro";
import ColorPalette from "../components/ColorPalette.astro";
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="Accueil">

<!-- ========================================================= -->
<!-- HERO -->
<!-- ========================================================= -->
<section 
  class="parallax-section relative w-screen h-[40vh] md:h-[30vh] flex items-center justify-center overflow-hidden" 
  data-parallax-speed="90"
>
  <!-- Image de fond avec effet parallaxe -->
  <div class="absolute inset-0 scale-110" data-parallax-target>
    <img src="/images/hero-hamon.png" alt="Ligne du hamon sur lame" class="w-full h-full object-cover" />
  </div>

  <!-- Overlay dégradé -->
  <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-black/20 to-transparent"></div>

  <!-- Contenu -->
  <div class="relative z-10 flex flex-col items-center justify-center h-full text-center text-white px-4">
    <h1 id="hero-title" class="halo fade-in-up text-4xl md:text-6xl font-serif mb-4 tracking-wide">
      L’art dans la lame
    </h1>
    <p id="hero-subtitle" class="text-lg md:text-xl text-white max-w-2xl mx-auto opacity-0">
      La ligne du <em>hamon</em> reflète l’histoire de l’acier et l’intention de l’artisan.
    </p>
  </div>
</section>



<!-- ========================================================= -->
<!-- SECTION CENTRALE                                          -->
<!-- ========================================================= -->
<section class="container mx-auto px-4 py-16 grid md:grid-cols-2 gap-12 items-center">
  <div class="relative fade-in">
    <img 
      src="/images/portrait-yann.jpg" 
      alt="Portrait de Yann, artisan coutelier"
      class="img-zoom max-w-md w-full h-auto rounded-lg shadow-xl object-cover border-4 border-accent mx-auto md:mx-0 reveal-child"
    />
  </div>
  <div class="fade-in">
    <h2 class="text-3xl md:text-4xl font-serif font-bold mb-6 text-accent reveal-child">
      Bienvenue à l’atelier sous l’éclipse
    </h2>
    <p class="text-lg text-muted leading-relaxed mb-4 reveal-child">
      Mon premier langage fut celui des ordinateurs et des infrastructures invisibles, un monde où la précision est une loi et la patience une vertu.<br />
      Aujourd'hui, je parle une autre langue : celle du métal et du bois.<br />
      Dans chaque barre d’acier, une promesse silencieuse.
    </p>
    <p class="text-lg text-muted leading-relaxed mb-6 italic reveal-child">
      Mes créations portent la mémoire du feu, du geste et de l’âme.
    </p>
    <a href="/me-connaitre" class="cta-premium inline-block px-6 py-3 text-white rounded reveal-child">
      En savoir plus
    </a>
  </div>
</section>


  <!-- ========================================================= -->
  <!-- SECTION POINÇON -->
  <!-- ========================================================= -->
  <section 
    class="parallax-section relative w-screen h-[60vh] overflow-hidden" 
    data-parallax-speed="60"
    data-parallax-zoom="1"
    data-parallax-zoom-strength="0.04"
  >
    <div class="absolute inset-0 scale-110" data-parallax-target>
      <img src="/images/gros-plan-poincon.jpg" alt="Détail poinçon sur lame" class="w-full h-full object-cover" />
    </div>
    <div class="absolute inset-0 bg-black/30"></div>
  </section>


<!-- ========================================================= -->
<!-- SECTION 2 : À chaque utilisation son couteau              -->
<!-- ========================================================= -->
<section class="bg-bg text-text py-16">
  <div class="container mx-auto px-4 grid md:grid-cols-2 gap-12 items-center">

    <!-- 📷 SLIDER PREMIUM -->
    <div class="relative overflow-hidden rounded-lg shadow-lg group fade-slide-up h-full">
      <div class="slideshow h-full">
        <img src="/images/couteau-grand-bonap.jpg" alt="Couteau artisanal Atelier sous l'éclipse Grand Bon'Ap" class="slide active" />
        <img src="/images/couteau_nakiri.jpg" alt="Couteau artisanal Atelier sous l'éclipse Nakiri" class="slide" />
        <img src="/images/couteau-kiritsuke.jpg" alt="Couteau artisanal Atelier sous l'éclipse Kiritsuke" class="slide" />
        <img src="/images/couteau-baby-bonap.jpg" alt="Couteau artisanal Atelier sous l'éclipse Baby Bon'Ap" class="slide" />
        <img src="/images/couteau-camp.jpg" alt="Couteau artisanal Atelier sous l'éclipse de Camp" class="slide" />
        <img src="/images/couteau-trancheur.jpg" alt="Couteau artisanal Atelier sous l'éclipse Trancheur" class="slide" />
        <img src="/images/couteau-table.jpg" alt="Couteau artisanal Atelier sous l'éclipse de table" class="slide" />
        <img src="/images/couteau-long-bonap.jpg" alt="Couteau artisanal Atelier sous l'éclipse Long Bon'Ap" class="slide" />
        <img src="/images/couteau-petty.jpg" alt="Couteau artisanal Atelier sous l'éclipse Petty" class="slide" />
        <img src="/images/couteau-gyuto.jpg" alt="Couteau artisanal Atelier sous l'éclipse Gyuto" class="slide" />
        <img src="/images/couteau-fighter.jpg" alt="Couteau artisanal Atelier sous l'éclipse Fighter" class="slide" />       
      </div>
    </div>

    <!-- 📝 TEXTE -->
    <div class="space-y-6 fade-slide-up">
      <h2 class="text-3xl md:text-4xl font-serif font-bold text-accent reveal-child">
        À chaque utilisation son couteau
      </h2>
      <p class="text-lg text-muted leading-relaxed reveal-child">
        Je prends un plaisir particulier à façonner des couteaux de cuisine — la gourmandise, ça ne s’invente pas ! 
        La plupart de mes créations se destinent aux arts de la table, mais je réalise aussi des pièces utilitaires, 
        d’extérieur, voire de chasse.
      </p>
      <p class="text-lg text-muted leading-relaxed reveal-child">
        Chaque usage appelle son acier. Pour la cuisine, je privilégie des aciers peu alliés mais riches en carbone, 
        offrant un tranchant exceptionnel. Pour un couteau de camp, je sélectionne un acier plus chargé, 
        résistant mieux aux contraintes et à l’abrasion. Associés à un profil et une géométrie adaptés, 
        ils donnent naissance à des lames agréables en main, précises et durables.
      </p>
    </div>
  </div>
</section>



<!-- ========================================================= -->
<!-- SECTION 3 : Inspiration + Galerie hamon                   -->
<!-- ========================================================= -->
<section class="w-full max-w-none bg-surface py-16 inspiration-section">
  <div class="max-w-6xl mx-auto px-4 space-y-10">

    <!-- 📝 TEXTE -->
    <div class="space-y-6 max-w-3xl mx-auto text-center fade-in">
      <h2 class="text-3xl md:text-4xl font-serif font-bold text-accent reveal-child">
        Inspiration
      </h2>
      <p class="text-lg text-muted leading-relaxed reveal-child">
        L’esthétique japonaise, sobre et naturelle, m’inspire profondément. 
        J’aime travailler des matières authentiques pour les manches : textures brutes, couleurs organiques.
      </p>
      <p class="text-lg text-muted leading-relaxed reveal-child">
        Sur beaucoup de mes créations, vous remarquerez une “ligne” sur la lame : le <em>hamon</em>. 
        Parfois fluide, parfois indomptée, c’est la signature laissée par la trempe sélective — 
        un savoir-faire ancestral japonais. Chaque hamon est unique, fruit de l’acier, du feu et du geste.
      </p>
    </div>

    <!-- Swiper -->
    <div class="swiper hamon-swiper slide-up">
      <div class="swiper-wrapper">
    {[
      "hamon-1.jpg",
      "hamon-2.jpg",
      "hamon-3.jpg",
      "hamon-4.jpg",
      "hamon-5.jpg",
      "hamon-6.jpg"
    ].map(img => (
      <div class="swiper-slide">
        <div class="hamon-card">
          <a href={`/images/${img}`} class="glightbox" data-gallery="hamon">
            <img src={`/images/${img}`} alt={`Détail de ${img}`} class="hamon-photo" />
          </a>
        </div>
      </div>
    ))}
  </div>
  <div class="swiper-button-next"></div>
  <div class="swiper-button-prev"></div>
  <div class="swiper-pagination"></div>
</div>
  </div>
</section>


<!-- ========================================================= -->
<!-- BLOC PREMIUM FINAL AVEC IMAGE, CITATION, ANIMATIONS & CARTE 3D -->
<!-- ========================================================= -->
<section 
  class="parallax-section premium-section relative w-full h-[60vh] flex items-center justify-center text-center text-white overflow-hidden"
  data-parallax-speed="60"
  data-parallax-zoom="1.05"
  data-parallax-zoom-strength="0.04"
>
  <!-- Image de fond -->
  <div class="absolute inset-0" data-parallax-target>
    <img 
      src="/images/packaging-ateliersousleclipse.jpg"
      alt="Emballage artisanal d’un couteau"
      class="w-full h-full object-cover object-center"
    />
  </div>

  <!-- Overlay sombre -->
  <div class="absolute inset-0 bg-black/45 backdrop-blur-[2px]"></div>

  <!-- Contenu principal -->
  <div class="relative z-10 px-4 max-w-6xl w-full space-y-6">
    <!-- Citation -->
    <p class="text-xl md:text-2xl font-serif italic fade-slide-up delay-0">
      « Chaque lame raconte une histoire… écrivons la vôtre. »
    </p>

    <!-- Boutons -->
    <div class="flex flex-col md:flex-row gap-3 justify-center fade-slide-up delay-150">
      <a href="/me-connaitre" class="cta-premium px-5 py-2.5 text-white rounded text-sm">Me connaître</a>
      <a href="/galerie" class="cta-premium px-5 py-2.5 text-white rounded text-sm">Voir la galerie</a>
    </div>

    <!-- Carte + Formulaire -->
    <div class="flex flex-col md:flex-row gap-6 justify-center items-center md:items-stretch mt-4 fade-slide-up delay-200">
      
      <!-- Carte 3D -->
      <div class="card-3d-wrapper fade-slide-up delay-300 w-full md:w-auto">
        <div class="card-3d">
          <div class="card-face card-front">
            <img src="/images/carte-visite-ateliersousleclipse-recto.jpg" alt="Carte recto" />
            <div class="card-reflection"></div>
            <div class="logo-glow" aria-hidden="true"></div>
          </div>
          <div class="card-face card-back">
            <img src="/images/carte-visite-ateliersousleclipse-verso.jpg" alt="Carte verso" />
            <div class="card-reflection"></div>
          </div>
        </div>
      </div>

      <!-- Formulaire (compact) -->
      <form action="/contact" method="POST" class="bg-black/30 p-4 rounded-lg space-y-3 w-full max-w-xs md:max-w-md fade-slide-up delay-450 flex flex-col justify-between">
        <div class="space-y-3">
          <input type="text" name="nom" placeholder="Votre nom" class="w-full p-2.5 rounded bg-white/90 text-black text-sm" required>
          <input type="email" name="email" placeholder="Votre email" class="w-full p-2.5 rounded bg-white/90 text-black text-sm" required>
          <textarea name="message" rows="3" placeholder="Votre message..." class="w-full p-2.5 rounded bg-white/90 text-black text-sm" required></textarea>
        </div>
        <button type="submit" class="cta-premium w-full px-5 py-2.5 rounded text-white text-sm">Envoyer</button>
      </form>

    </div>
  </div>
</section>

<!-- anim hero -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const title = document.getElementById('hero-title');
    const subtitle = document.getElementById('hero-subtitle');

    // Animation du titre (stagger: d'abord .fade-in-up, puis .visible)
    setTimeout(() => {
      title.classList.add('visible');           // état initial (opacity:0, translateY)
      requestAnimationFrame(() => {
        title.classList.add('visible');            // déclenche la transition vers l'état final
      });
    }, 500);

    // Animation lettre par lettre du sous-titre (inchangée)
    setTimeout(() => {
      const rawHTML = subtitle.innerHTML;
      const chars = rawHTML
        .split(/(<[^>]+>)/g)
        .map(part =>
          part.startsWith('<') && part.endsWith('>')
            ? part
            : part
                .split('')
                .map(c =>
                  c === ' '
                    ? '<span class="letter">&nbsp;</span>'
                    : `<span class="letter">${c}</span>`
                )
                .join('')
        )
        .join('');

      subtitle.innerHTML = chars;

      let delay = 0;
      subtitle.querySelectorAll('.letter').forEach(span => {
        span.style.animationDelay = `${delay}s`;
        delay += 0.03; // ta vitesse actuelle
      });

      subtitle.style.opacity = 1;
    }, 700);
  });
</script>



  <!-- SCRIPT CARTE VISITE -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const wrapper = document.querySelector(".card-3d-wrapper");
  const card = wrapper?.querySelector(".card-3d");
  const frontReflection = wrapper?.querySelector(".card-front .card-reflection");
  const backReflection  = wrapper?.querySelector(".card-back  .card-reflection");
  const logoGlow        = wrapper?.querySelector(".card-front .logo-glow");
  if (!wrapper || !card || !frontReflection || !backReflection || !logoGlow) return;

  let isFlipped = false;
  let rx = 0, ry = 0;

  const clamp = (v, min, max) => Math.max(min, Math.min(max, v));

  const applyTransform = () => {
    // Flip + tilt
    const flip = isFlipped ? 'rotateY(180deg)' : 'rotateY(0deg)';
    card.style.transform = `${flip} rotateX(${rx}deg) rotateY(${ry}deg)`;

    // Ombre dynamique (plus visible)
    const shadowX = ry * -3.2;
    const shadowY = rx * 3.2;
    const blur    = 46;
    const alpha   = 0.40;
    card.style.boxShadow = `${shadowX}px ${shadowY}px ${blur}px rgba(0,0,0,${alpha})`;

    // Reflet vernis: on décale la position du dégradé
    // Front suit le tilt, Back inverse pour rester "logique" après flip
    const refFront = 50 + clamp(ry, -12, 12) * 3;  // 50% +/- 36%
    const refBack  = 50 - clamp(ry, -12, 12) * 3;
    frontReflection.style.setProperty('--reflectX', `${refFront}%`);
    backReflection.style.setProperty('--reflectX',  `${refBack}%`);

    // Lueur logo visible seulement quand recto face à l'utilisateur
    logoGlow.style.opacity = isFlipped ? '0' : '1';
  };

  const setTilt = (e) => {
    const rect = wrapper.getBoundingClientRect();
    const x = e.clientX - rect.left - rect.width / 2;
    const y = e.clientY - rect.top  - rect.height / 2;
    rx = clamp((-y / rect.height) * 10, -10, 10);
    ry = clamp(( x / rect.width)  * 10, -10, 10);
    applyTransform();
  };

  // Flip au survol (desktop) + retour à plat
  wrapper.addEventListener("mouseenter", () => { isFlipped = true;  applyTransform(); });
  wrapper.addEventListener("mouseleave", () => { isFlipped = false; rx = 0; ry = 0; applyTransform(); });

  // Tilt
  wrapper.addEventListener("mousemove", setTilt);

  // Fallback mobile: flip au tap
  wrapper.addEventListener("click", () => { isFlipped = !isFlipped; applyTransform(); });
});
</script>

  <!-- SCRIPT SLIDESHOW SECTION 2 -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const slides = document.querySelectorAll('.slideshow .slide');
    let index = 0;

    setInterval(() => {
      slides[index].classList.remove('active');
      index = (index + 1) % slides.length;
      slides[index].classList.add('active');
    }, 4000); // change toutes les 5s
  });
</script>


</BaseLayout